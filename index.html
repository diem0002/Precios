<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#682854">
    <title>Consulta de Bodegas</title>
    <link rel="icon" href="img/icon.png" type="image/png">
    <link rel="apple-touch-icon" href="img/icon-192.png">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>
<body>
  <img src="./img/compañia de vinos logos-03.png" alt="Logo de la vinoteca" class="logo">
  <h1>Consulta de Productos por Bodega</h1>

  <div id="connection-status" class="hidden">
    <p>Conectando al servidor para obtener datos actualizados...</p>
  </div>

  <!-- Escáner QR -->
  <div id="scanner-section">
    <button id="startScanner" class="btn btn-scan">Iniciar Escáner QR</button>
    <div class="scanner-container hidden" id="scannerContainer">
      <canvas id="scanner" class="hidden"></canvas>
      <video id="video" width="100%" autoplay playsinline class="hidden"></video>
      <button id="stopScanner" class="btn">Detener Escáner</button>
    </div>
  </div>

  <!-- Búsqueda manual -->
  <div id="manual-search">
    <button id="toggleManualSearch" class="btn">Buscar Bodega Manualmente</button>
    <div id="manualInputContainer" class="hidden">
      <input type="text" id="manualBodegaInput" placeholder="Escribí el nombre de la bodega" class="manual-input">
      <button id="manualSearchBtn" class="btn">Buscar</button>
    </div>
    <div id="historyContainer" class="hidden">
      <p>Búsquedas recientes:</p>
      <ul id="historyList"></ul>
    </div>
  </div>

  <!-- Resultado -->
  <div id="result">Escanea un código QR o buscá manualmente para ver los productos</div>

  <!-- Loading -->
  <div id="loading" class="loading hidden">
    <p>Cargando datos actualizados...</p>
  </div>

  <!-- Tabla -->
  <div id="products-container" class="hidden">
    <h2>Productos en Bodega: <span id="bodega-name"></span></h2>
    <div class="last-update">Última actualización: <span id="last-update-time"></span></div>
    <table id="products-table">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Bodega</th>
          <th>Precio</th>
        </tr>
      </thead>
      <tbody id="products-body">
        <!-- Productos insertados dinámicamente -->
      </tbody>
    </table>
  </div>

  <script src="./js/sw-register.js"></script>
  <script src="./js/main.js"></script>
</body>
</html>